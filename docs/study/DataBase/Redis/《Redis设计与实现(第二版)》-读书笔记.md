# 《Redis设计与实现(第二版)》-读书笔记

# 1. 引言

## 1.1 Redis版本说明

## 1.2 章节编排

## 1.3 推荐的阅读方法

## 1.4 行文规则

## 1.5 配套网站

redisbook.com

# 第一部分 数据结构与对象

# 2. 简单动态字符串

+ C语言传统字符串，即以空字符结尾的字符数组。
+ Redis自己构建名为简单动态字符串（simple dynamic string，SDS）的抽象类型，用作默认字符串表示。

当需要<u>可修改的字符串</u>（非字符串字面量）时，Redis使用SDS表示字符串值。比如，在Redis数据库中，包含字符串的键值对在底层都是由SDS实现的。

SDS在Redis中的使用场景：

+ 保存数据库中的字符串值（key或value的字符串值）
+ 用作缓冲区（buffer）：AOF模块中的AOF缓冲区，以及客户端状态中的输入缓冲区。

## 2.1 SDS的定义

> src/sds.h 源代码中有很多内存优化版本，这里取其共同结构。（这本书的描述较老，建议结合新版源码查阅相关文章学习）

```c
struct sdshdr {
  int len;
  int alloc;
  char flags;
  char buf[];
}
```

